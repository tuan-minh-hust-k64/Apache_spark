import pandas as pd
import os
folder_path = 'F:\\workspace\java\\apache-spark\\src\\main\\resources\\ltv'
file_names = os.listdir(folder_path)
for file_name in file_names:
    file_path = os.path.join(folder_path, file_name)
    df = pd.read_csv(file_path)
    df = df[df['ltv_ad_d0'].notna()]
    df.drop(columns=["ltv_ad_d31",
                     "ltv_ad_d32",
                     "ltv_ad_d33",
                     "ltv_ad_d34",
                     "ltv_ad_d35",
                     "ltv_ad_d36",
                     "ltv_ad_d37",
                     "ltv_ad_d38",
                     "ltv_ad_d39",
                     "ltv_ad_d40",
                     "ltv_ad_d41",
                     "ltv_ad_d42",
                     "ltv_ad_d43",
                     "ltv_ad_d44",
                     "ltv_ad_d45",
                     "ltv_ad_d46",
                     "ltv_ad_d47",
                     "ltv_ad_d48",
                     "ltv_ad_d49",
                     "ltv_ad_d50",
                     "ltv_ad_d51",
                     "ltv_ad_d52",
                     "ltv_ad_d53",
                     "ltv_ad_d54",
                     "ltv_ad_d55",
                     "ltv_ad_d56",
                     "ltv_ad_d57",
                     "ltv_ad_d58",
                     "ltv_ad_d59",
                     "ltv_ad_d60",
                     "ltv_iap_d0",
                     "ltv_iap_d1",
                     "ltv_iap_d2",
                     "ltv_iap_d3",
                     "ltv_iap_d4",
                     "ltv_iap_d5",
                     "ltv_iap_d6",
                     "ltv_iap_d7",
                     "ltv_iap_d8",
                     "ltv_iap_d9",
                     "ltv_iap_d10",
                     "ltv_iap_d11",
                     "ltv_iap_d12",
                     "ltv_iap_d13",
                     "ltv_iap_d14",
                     "ltv_iap_d15",
                     "ltv_iap_d16",
                     "ltv_iap_d17",
                     "ltv_iap_d18",
                     "ltv_iap_d19",
                     "ltv_iap_d20",
                     "ltv_iap_d21",
                     "ltv_iap_d22",
                     "ltv_iap_d23",
                     "ltv_iap_d24",
                     "ltv_iap_d25",
                     "ltv_iap_d26",
                     "ltv_iap_d27",
                     "ltv_iap_d28",
                     "ltv_iap_d29",
                     "ltv_iap_d30",
                     "ltv_iap_d31",
                     "ltv_iap_d32",
                     "ltv_iap_d33",
                     "ltv_iap_d34",
                     "ltv_iap_d35",
                     "ltv_iap_d36",
                     "ltv_iap_d37",
                     "ltv_iap_d38",
                     "ltv_iap_d39",
                     "ltv_iap_d40",
                     "ltv_iap_d41",
                     "ltv_iap_d42",
                     "ltv_iap_d43",
                     "ltv_iap_d44",
                     "ltv_iap_d45",
                     "ltv_iap_d46",
                     "ltv_iap_d47",
                     "ltv_iap_d48",
                     "ltv_iap_d49",
                     "ltv_iap_d50",
                     "ltv_iap_d51",
                     "ltv_iap_d52",
                     "ltv_iap_d53",
                     "ltv_iap_d54",
                     "ltv_iap_d55",
                     "ltv_iap_d56",
                     "ltv_iap_d57",
                     "ltv_iap_d58",
                     "ltv_iap_d59",
                     "ltv_iap_d60",
                     "ltv_total_d0",
                     "ltv_total_d1",
                     "ltv_total_d2",
                     "ltv_total_d3",
                     "ltv_total_d4",
                     "ltv_total_d5",
                     "ltv_total_d6",
                     "ltv_total_d7",
                     "ltv_total_d8",
                     "ltv_total_d9",
                     "ltv_total_d10",
                     "ltv_total_d11",
                     "ltv_total_d12",
                     "ltv_total_d13",
                     "ltv_total_d14",
                     "ltv_total_d15",
                     "ltv_total_d16",
                     "ltv_total_d17",
                     "ltv_total_d18",
                     "ltv_total_d19",
                     "ltv_total_d20",
                     "ltv_total_d21",
                     "ltv_total_d22",
                     "ltv_total_d23",
                     "ltv_total_d24",
                     "ltv_total_d25",
                     "ltv_total_d26",
                     "ltv_total_d27",
                     "ltv_total_d28",
                     "ltv_total_d29",
                     "ltv_total_d30",
                     "ltv_total_d31",
                     "ltv_total_d32",
                     "ltv_total_d33",
                     "ltv_total_d34",
                     "ltv_total_d35",
                     "ltv_total_d36",
                     "ltv_total_d37",
                     "ltv_total_d38",
                     "ltv_total_d39",
                     "ltv_total_d40",
                     "ltv_total_d41",
                     "ltv_total_d42",
                     "ltv_total_d43",
                     "ltv_total_d44",
                     "ltv_total_d45",
                     "ltv_total_d46",
                     "ltv_total_d47",
                     "ltv_total_d48",
                     "ltv_total_d49",
                     "ltv_total_d50",
                     "ltv_total_d51",
                     "ltv_total_d52",
                     "ltv_total_d53",
                     "ltv_total_d54",
                     "ltv_total_d55",
                     "ltv_total_d56",
                     "ltv_total_d57",
                     "ltv_total_d58",
                     "ltv_total_d59",
                     "ltv_total_d60"])
    df['labels'] = str(df["ltv_ad_d0"]) + "," + str(df["ltv_ad_d1"]) + "," + str(df["ltv_ad_d2"]) + "," + str(df["ltv_ad_d3"])
print("ok")